#### 什么是作用域链?

先说下作用域的这个概念，作用域就是变量和函数的可访问范围，控制这个变量或者函数可访问行和生命周期（这个很重要）。

在 js 中是词法作用域，意思就是你的变量函数的作用域是由你的编码中的位置决定的，当然可以通过 apply bind 等函数进行修改。

在 ES6 之前，js 中的作用域分为两种：函数作用域和全局作用域。

全局作用域顾名思义，浏览器下就是 window ，作用域链的顶级就是它，那么只要不是被函数包裹的变量或者函数，它的作用域就是全局。

而函数作用域，就是在函数的体内声明的变量、函数及函数的参数，它们的作用域都是在这个函数内部。
那么函数中的未在该函数内定义的变量呢？这个变量怎么获取呢？这就是作用域链的概念了。

我们知道函数在执行时是有个执行栈，在函数执行的时候会创建执行环境，也就是执行上下文，在上下文中有个大对象，保存执行环境定义的变量和函数，在使用变量的时候，就会访问这个大对象，这个对象会随着函数的调用而创建，函数执行结束出栈而销毁，那么这些大对象组成一个链，就是作用域链。

那么函数内部未定义的变量，就会顺着作用域链向上查找，一直找到同名的属性。

看下面这个栗子

```js
var a = 10;
function fn() {
  var b = 20;
  function bar() {
    console.log(a + b) // a 一直往上找，直到最高层级找到了， b 往上找，在函数 fn 这一层级的上下文中找到了 b=20 ，就没有继续往上找
  }
  return bar
}
b = 200;
var x = fn();
x()
```